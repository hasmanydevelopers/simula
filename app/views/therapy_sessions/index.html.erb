<% if current_user.type == "Users::Supervisor" %>
  <% @sessions_list.each do |state, sessions_by_date| %>
    <nav class="navbar navbar-default" role="navigation">
      <div class="navbar-header">
        <% if sessions_by_date.count == 0 %>
          <button id="sessions-count-btn" type="button" class="<%= state %> navbar-toggle btn-lg" data-toggle="collapse" data-target="#empty<%= state %>"><%= sessions_by_date.count %></button>
        <% else %>
          <button id="sessions-count-btn" type="button" class="<%= state %> navbar-toggle btn-lg" data-toggle="collapse" data-target="#<%= state %>"><%= sessions_by_date.count %></button>
        <% end %>
          <a id="state-detail" class="navbar-brand"><%= state %> sessions</a>
      </div>
      <ul class="collapse navbar-collapse nav navbar-nav" id="empty<%= state %>">
        <li><a id="sessions-index-msg" class="navbar-brand">You don't have <%= state %> sessions.</a>
        </li>
      </ul>
      <ul class="collapse navbar-collapse nav navbar-nav" id="<%= state %>">
        <% sessions_by_date.each do |date, sessions| %>
          <nav class="navbar navbar-default" role="navigation">
            <div class="navbar-header">
                <button id="sessions-count-btn" type="button" class="<%= state %> navbar-toggle btn-lg" data-toggle="collapse" data-target="#<%= date %>"><%= sessions.count %></button>
                <a id="date-detail" class="navbar-brand"><%= date %></a>
            </div>
            <ul class="sessions-by-date collapse navbar-collapse nav navbar-nav" id="<%= date %>">
              <table class=""table table-striped"">
                <tbody>
                  <% sessions.each do |s| %>
                    <tr>
                      <td id="people-column">
                        <li type="circle"><b><%= s.therapist.complete_name %></b><br>
                          <%= s.patient.complete_name %>
                        </li>
                      </td>
                      <% unless @state == "confirmed" %>
                        <td id="edit-btn">

                        </td>
                      <% end %>
                    </tr>
                  <% end %>
                <tbody>
              </table>
            </ul>
          </nav>
        <% end %>
      </ul>
    </nav>
  <% end %>
<% elsif @sessions_list.empty? %>
  <ol class="breadcrumb">
    <li><a id="sessions-index-msg" class="navbar-brand"><%= @sessions_index_msg %></a></li>
  </ol>
<% else %>
  <% @sessions_list.each do |date, sessions| %>
    <nav class="navbar navbar-default" role="navigation">
      <div class="navbar-header">
          <button id="sessions-count-btn" type="button" class="<%= @state %> navbar-toggle btn-lg" data-toggle="collapse" data-target="#<%= date %>"><%= sessions.count %></button>
          <a id="date-detail" class="navbar-brand"><%= date %></a>
      </div>
      <ul class="sessions-by-date collapse navbar-collapse nav navbar-nav" id="<%= date %>">
        <table class=""table table-striped"">
          <tbody>
            <% sessions.each do |s| %>
              <tr>
                <td id="people-column">
                  <% if @rol == "therapist" %>
                    <li type="circle"><%= s.patient.complete_name %><br>
                      <%= s.supervisor.complete_name %>
                    </li>
                  <% elsif @rol == "patient" %>
                    <li type="circle"><%= s.therapist.complete_name %><br>
                        <%= s.supervisor.complete_name %>
                    </li>
                  <% elsif s.therapist_id == current_user.id %>
                    <li type="circle"><%= s.patient.complete_name %> <b>(Patient)</b>
                    </li>
                  <% elsif s.patient_id == current_user.id %>
                    <li type="circle"><%= s.therapist.complete_name %> <b>(Therapist)</b>
                    </li>
                  <% end %>
                </td>
                <% unless @state == "confirmed" %>
                  <td id="edit-btn">
                      <%= link_to content_tag(:span, "", :class => "glyphicon glyphicon-pencil"), edit_therapy_session_path(s.id), method: :get, :class => "btn btn-default btn-lg" %>
                  </td>
                <% end %>
              </tr>
            <% end %>
          <tbody>
        </table>
      </ul>
    </nav>
  <% end %>
<% end %>


