<% @sessions_list.each do |state, sessions_by_date| %>
  <nav class="navbar navbar-default" role="navigation">
    <div class="navbar-header">
      <button id="sessions-count-btn" type="button" class="<%= state %> navbar-toggle btn-lg" data-toggle="collapse" data-target="#<%= state %>"><%= sessions_by_date[0] %></button>
      <a id="state-detail" class="navbar-brand"><%= state == :pending ? "Sessions #{state} for confirmation" : "#{state} sessions" %></a>
    </div>
    <ul class="collapse navbar-collapse nav navbar-nav" id="<%= state %>">
      <% if sessions_by_date[1].count == 0 %>
        <li>
          <a id="sessions-index-msg" class="navbar-brand"><%= state == :pending ? "You have no sessions #{state} for confirmation." : "You have no #{state} sessions." %></a>
        </li>
      <% else %>
        <% sessions_by_date[1].each do |date, sessions| %>
          <nav class="navbar navbar-default" role="navigation">
            <div class="navbar-header">
                <button id="sessions-count-btn" type="button" class="<%= state %> navbar-toggle btn-lg" data-toggle="collapse" data-target="#<%= date %>"><%= sessions.count %></button>
                <a id="date-detail" class="navbar-brand"><%= date %></a>
            </div>
            <ul class="sessions-by-date collapse navbar-collapse nav navbar-nav" id="<%= date %>">
              <table class=""table table-striped"">
                <tbody>
                  <% sessions.each do |s| %>
                    <tr>
                      <td id="people-column">
                        <li type="circle"><b><%= s.therapist.complete_name %></b><br>
                          <%= s.patient.complete_name %>
                        </li>
                      </td>
                      <% if s.state == "confirmed" %>
                        <td id="edit-btn">
                          <div class="btn-group">
                            <%= content_tag(:a, content_tag(:span, "", :class => "glyphicon glyphicon-ok"), :class => "confirm-btn active btn btn-default btn-lg") %>
                            <%= link_to content_tag(:span, "", :class => "glyphicon glyphicon-remove"), change_therapy_session_state_path(s.id), method: :get, :class => "reject-btn no-active btn btn-default btn-lg" %>
                          </div>
                        </td>
                      <% elsif s.state == "rejected" %>
                        <td id="edit-btn">
                          <div class="btn-group">
                            <%= link_to content_tag(:span, "", :class => "glyphicon glyphicon-ok"), change_therapy_session_state_path(s.id), method: :get, :class => "confirm-btn no-active btn btn-default btn-lg" %>
                            <%= content_tag(:a, content_tag(:span, "", :class => "glyphicon glyphicon-remove"), :class => "reject-btn active btn btn-default btn-lg") %>
                          </div>
                        </td>
                      <% else %>
                        <td id="edit-btn">
                          <div class="btn-group">
                            <%= link_to content_tag(:span, "", :class => "glyphicon glyphicon-ok"), change_therapy_session_state_path(id: s.id, new_state: :confirmed), method: :get, :class => "confirm-btn btn btn-default btn-lg" %>
                            <%= link_to content_tag(:span, "", :class => "glyphicon glyphicon-remove"), change_therapy_session_state_path(id: s.id, new_state: :rejected), method: :get, :class => "reject-btn btn btn-default btn-lg" %>
                          </div>
                        </td>
                      <% end %>
                    </tr>
                  <% end %>
                <tbody>
              </table>
            </ul>
          </nav>
        <% end %>
      <% end %>
    </ul>
  </nav>
<% end %>
